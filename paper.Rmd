---
title: |
  A slice tour for finding hollowness in high-dimensional data
type: Short Technical Note
author:
  - name: Ursula Laa
    affil: a, b
    email: ursula.laa@monash.edu
  - name: Dianne Cook
    affil: b
    email: dicook@monash.edu
  - name: German Valencia
    affil: a
    email: german.valencia@monash.edu
affiliation:
  - num: a
    address: |
      School of Physics and Astronomy, Monash University
  - num: b
    address: |
      Department of Econometrics and Business Statistics, Monash University
bibliography: biblio.bib
geometry: margin=2.5cm
abstract: |
  Taking projections of high-dimensional data is a common analytical and visualisation technique in statistics for working with high-dimensional problems. Sectioning, or slicing, through high dimensions is less common, but can be useful for visualising data with concavities, or non-linear structure. It is associated with conditional distributions in statistics, and also linked brushing between plots in interactive data visualisation. This short technical note describes a simple approach for  slicing in the orthogonal
  space of projections obtained when running a tour, thus presenting the viewer
  with an interpolated sequence of projected sections. The method has been
  implemented in R as an extension to the tourr package, and can be used to
  explore for concave and non-linear structures in multivariate distributions.
keywords: |
  data visualisation; grand tour; sectioning
header-includes: |
  \usepackage{hyperref}
  \usepackage[utf8]{inputenc}
  \def\tightlist{}
  \usepackage{setspace}
output: rticles::tf_article
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE)
```

\doublespacing
# Introduction

<!-- Background -->
Data is commonly high-dimensional, and visualisation often relies on some form of dimension reduction. This can be by taking linear projections, or nonlinear, if one considers techniques like multidimensional scaling (MDS) or t-Distributed Stochastic Neighbor Embedding (t-SNE). For the purposes here, the focus is on linear projections, in particular as provided by the grand tour [@As85; @BCAH05]. Interactive and dynamic displays can provide information beyond what can be achieved in a static display. The grand tour shows a smooth sequence of interpolated low dimensional projections, and allows the viewer to extrapolate from the low-dimensional shapes to the multidimensional distribution. It is particularly useful for detecting clusters, outliers and non-linear dependence. 

<!-- The disadvantage of projection: opacity, occlusion, even with pseudo-transparency from scatterplots;  motivation -->
A major limitation of projections is their opacity. It is mitigated some, when scatterplots are used to render the projected data, through a pseudo-transparency of sparseness of points. This is improved further if points are also drawn using an alpha level that provides transparent dots on most display devices. Some features of multivariate distributions may be visible, but a lot is easily hidden, especially in the case of concave structures. Considering the example of a simple geometric shape such as a hypershere, it is difficult to distinguish between a full or a hollow sphere, that is, whether points are uniformly distributed within the sphere or on the surface of a sphere. Similarly we can think of small scale structures hidden in the center of a multivariate distribution, that might be considered to be "needles in a haystack", which can be difficult to detect in projections. Projections also obscure non-linear boundaries as might be constructed from a classification model, or nonlinear model fits in high-dimensions. 

<!-- Our approach: introduce sections; many different ways to slice, refer to linked brushing as slicing whcih mirrors prosection, but here we will explain/utilise a simple slicing on the projection where point in orthogonal space are faded. -->
Slicing, or sectioning, is a way that the internal distribution of high-dimensional data can be explored. @prosection discusses a technique for combining projections, with sections constructed by slicing in the dimensions orthogonal to the projection. It is also possible to think of linked brushing (e.g. @ggobiCSDA2003, @JSSv081i05) as slicing. In this note, we discuss an approach to sectioning, where observations in the space orthogonal to the projection are highlighted if they are close to a projection plane through the mean of the data, and faded if further afield. This is combined with the grand tour to provide a new dynamic display that can be used to systematically search for features hidden in high dimensions.

<!-- paper structure --> 
The new section tour method is described in Section \ref{sec:method}, and it is implemented in the `tourr` [@tourr] package in R [@rref] (Section \ref{sec:implementation}).  Section \ref{sec:examples} illustrates the use on several high-dimensional geometric shapes and established data sets, showing how concave or occluded structures can be visualised and explored with a slice tour. Future work is discussed in Section \ref{sec:discussion}.

# Method {#sec:method}

## Tour review

A tour provides a continuous sequence of $d$-dimensional (typically $d=1$ or $2$) projections from $p$-dimensional Euclidean space. It is constructed by combining a method for basis selection with geodesic interpolation between pairs of bases. In a grand tour, the basis selection is random, each new basis is chosen from all possible projections. In a guided tour, the bases are chosen based on an index of interestingness. Different basis selection methods as well as the geodesic interpolation are implemented in the `tourr` package [@tourr], which also provides several display functions for viewing the tour.

For the explanation of the slice tour, the actual mechanics of the tour are not important, and only the notion of a projection plane in high dimensions is needed. The notation used for explanations starts with deoting each projection as $\mathbf{X}$ the $n\times p$ dimensional data matrix ($n$ observations in $p$ dimensions) and $\mathbf{A}$ an orthonormal $p \times d$ projection matrix. The $d$-dimensional projection of the data is thus given by $\mathbf{Y} = \mathbf{X}\cdot\mathbf{A}$, producing the $n\times d$ dimensional projected data matrix to be plotted in each frame of the tour display.

To make a section, we are interested in the orthogonal distance of the data points from an anchored projection plane, particularly using $d=2$, but the approach theoretically works for any $d$. 

## Slicing in the orthogonal space

### Distance from the origin

The orthogonal distance of the data points from the current projection plane centered at the data mean, is calculated as, 

\begin{equation}
\tilde{v}_i^2 = ||\mathbf{x}_i'||^2.
\end{equation}

\noindent where 

\begin{equation}
\mathbf{x}_i' = \mathbf{x}_i - (\mathbf{x}_i\cdot \mathbf{a}_1) \mathbf{a}_1 - (\mathbf{x}_i\cdot \mathbf{a}_2) \mathbf{a}_2
\end{equation}

\noindent and $\mathbf{x}_i, i=1,...,n$ is a $p$-dimensional observation in $\mathbf{X}$ and $\mathbf{a}_i, i=1,2$ denoting the columns of the projection matrix, $\mathbf{A}=(\mathbf{a}_1, \mathbf{a}_2)$.
Calculating the euclidean norm of $\mathbf{x}'$ is straightforward thanks to the orthonormality of $\mathbf{A}$, and gives the components of the required distance vector. This can be generalized for $d>2$.

The distance vector can then be used to display a slice tour by highlighting points for which the orthogonal distance is smaller than a selected cutoff value $h$. In 3D, where for each plane there is only a single orthogonal direction, this defines a flat slice of height $2h$. We could use this single direction to slice systematically from one side of the space to the other. It is also possible to think of front and back, some points are closer to the viewer, and some are far, and depth cues could be used. When going beyond 3D, the dimension of the orthogonal space is $>1$, and all sense of direction is lost. In general, there are $(p-d)$ dimensions orthogonal to the projection plane, so using distance from the points to the plane is the simplest approach to generating slices. Using the euclidean distance results in rotation invariant slicing in the orthogonal space, where a "slice" is spherical in the orthogonal subspace, and has radius $h$.

Figure \ref{fig:renderFunction} shows slices through 4D solid and hollow geometric shapes. For each shape, the points are generated either uniformly within the shape, or on the surface. This illustrates the ease of distinguishing the solid from the hollow, once slices are made.  

```{r renderFunction, echo=FALSE, eval=TRUE, warning=FALSE, fig.height=1.5, fig.width = 5.5, fig.cap="Projected slices through 4d geometric shapes. On the left a full (hollow) hypersphere (a, b), on the right a full (hollow) hypercube (c, d). Points inside the slice are shown as black bullets, points outside the slice are shown as grey dots. We can clearly distinguish the full from the hollow objects based on the slice display.\\label{fig:renderFunction}"}
library(tidyverse)

# slight modification of the function in tourr::display_slice
render_data <- function(data, proj, h, anchor) {
    # Render projected points
    x <- data %*% proj
    d <- tourr::anchored_orthogonal_distance(proj, data, anchor)
    pch <- rep(46, nrow(x))
    pch[d < h] <- 20
    col <- rep("grey", nrow(x))
    col[d < h] <- "black"
    ggplot() +aes(x[,1], x[,2]) + geom_point(pch = pch, color=col) + theme_void() + coord_fixed()
}

anchor <- rep(0, 4)
plane <- tourr::basis_init(4, 2)
nPt <- 5000

set.seed(3008)

d1 <- geozoo::sphere.solid.random(4, nPt)$points
d2 <- geozoo::sphere.hollow(4, nPt)$points
d3 <- geozoo::cube.solid.random(4)$points[1:nPt,] %>% scale(scale = FALSE)
d4 <- geozoo::cube.face(4)$points[1:nPt,] %>% scale(scale = FALSE)

a <- render_data(d1, plane, 0.2, anchor) + labs(title="a")
b <- render_data(d2, plane, 0.2, anchor) + labs(title="b")
c <- render_data(d3, plane, 0.2, anchor) + labs(title="c")
d <- render_data(d4, plane, 0.2, anchor) + labs(title="d")

library(gridExtra)
grid.arrange(a, b, c, d, nrow=1)

```


### Slice thickness

Choosing the slice thickness is a compromise between what feature size can be resolved and the sparseness of the data. As $p$ increases, the relative number of points that are inside a slice of fixed thickness $h$ will decrease. The exact relation depends on the distribution of the data points. To get a best estimate for $h$, given $p$, assume that the points are uniformly distributed in a hypersphere. This is a rotation invariant uniform distribution in $p$ space, and because with sllicing we are mostly interested in hollowness this is more relevant than assuming a multivariate normal distribution.

The fraction of points inside a slice of thickness $h$ can be estimated as the relative volume of the slice compared to the volume of the full hypersphere,
\begin{equation}
V_{rel} = \frac{1}{2} \frac{h^{p-2}}{r^p} (p r^2 - (p-2) h^2) \approx \frac{1}{2} (\frac{h}{R})^{p-2},
\end{equation}
where $r$ is XXX, and $R$ is XXX. The approximation is valid when $h \ll r$, as is typically expected to be the case. To keep the relative number of points (i.e. $V_{rel}$) approximately constant for slices in different dimensions $p$, we calculate $h$ from a volume parameter as $h = \epsilon^{1/(p-2)}$, where $epsilon$ is a pre-chosen value indicating a fraction of the overall volume to slice, say 0.001.

*XXX Do we need a diagram?*

### Anchoring

The equations above assume that the projection plane, and thus the the slice, passes through 0, which will be the mean of centered data. This (anchor point) is generally a good option for the slice tour, because as the tour progresses the projection plane changes and can catch non-central concavities, too. However it is straightforward generalize the equations to use any anchor point, $\alpha$.

In general $\alpha$ can be any point in the $n$-dimensional parameter space, but we are only interested in the orthogonal component, the part of the vector extedning out of the projection plane, $\mathbf{\alpha}' = \mathbf{\alpha} - (\mathbf{\alpha}\cdot \mathbf{a}_1) \mathbf{a}_1 - (\mathbf{\alpha}\cdot \mathbf{a}_2 )\mathbf{a}_2$. The generalized measure of orthogonal distance is then
\begin{equation}
v_i^2 = ||\mathbf{x}_i' - \mathbf{\alpha}'||^2 = \mathbf{x}_i'^2 + \mathbf{\alpha}'^2 - 2 \mathbf{x}_i'\cdot\mathbf{\alpha}'
\end{equation}
where the cross term can be expressed as
\begin{equation}
\mathbf{x}_i'\cdot\mathbf{\alpha}' = \mathbf{x}_i\cdot\mathbf{\alpha} - (\mathbf{\alpha}\cdot \mathbf{a}_1) (\mathbf{x}_i\cdot \mathbf{a}_1) - (\mathbf{\alpha}\cdot \mathbf{a}_2) (\mathbf{x}_i\cdot \mathbf{a}_2).
\end{equation}

Using the generalized distance measure with a cutoff volume, $\epsilon$, then corresponds to moving a slice of fixed thickness, corresponding to a neighborhood of the projection plane through the anchor point $\mathbf{\alpha}$. In 3D, this simply corresponds to moving up or down along the orthogonal direction. Note that selecting an off-center anchor point may result in fewer points inside a slice for most data.

*XXX Do we need a diagram?*

# Implementation {#sec:implementation}

The slice tour has been implemented in R [@rref] as a new display method `display_slice` in the `tourr` package [@tourr]. In addition to usual parameters the user can choose the volume parameter $\epsilon$ by setting `eps` and, if required, the anchor point $\alpha$ is set by the `anchor` argument. By default `eps=0.001` and `anchor=NULL`, resulting in slicing through the mean In addition the user can select the marker symbols for point inside and outside the slice. By default points in the slice are highlighted as `pch_slice = 20` and `pch_other = 46`, i.e. plotting a bullet for points inside the slice, and a dot for points outside. Below we show example code for displaying slices through a hollow 3d sphere.

```{r codeExampel, echo=TRUE, eval=FALSE}
library(tourr)
# use geozoo to generate points on a hollow 3d sphere
sphere3 <- geozoo::sphere.hollow(3)$points
colnames(sphere3) <- c("x1", "x2", "x3") # naming variables
# slice tour animation with default settings
animate_slice(sphere3)
# trying an off-center anchor point, thicker slice, and
# we use pch=26 to hide points outside the slice
anchor3 <- rep(0.7, 3)
animate_slice(sphere3, anchor = anchor3, eps = 0.2, pch_other=26)
```

# Examples {#sec:examples}
## Geometric shapes
### Hollow sphere
We sample points on the surface of a sphere with radius $r=1$ in $p=3$ and $p=5$ dimensions. Using the `geozoo` package [@geozoo], we draw 2000 (5000) points that are uniformly distributed on the surface of a 3d (5d) sphere.
For both examples we start by slicing through the origin with the default parameters, in particular $\epsilon = 0.1$, i.e. $h = 0.1$ in 3d and $h = 0.46$ in 5d. Slicing through the origin results in sections where the points inside the slice are approximately on a circle with the full radius, and each view is similar to that shown in Figure~\ref{fig:renderFunction}. Animated gifs of these examples are available at XXX.

It is especially instructive to look at the sliced spheres with an off-center anchor point. In this case the different views obtained in the slice tour reveal more of the concave structure of the distribution. Figure \ref{fig:3anchored} shows example views from a slice tour on a 3d sphere with $r=1$ and anchor point $(0.7, 0.7, 0.7)$. Notice that the anchor point was chosen to fall outside the sphere. Depending on the viewing angle selected by the tour the slice contains points on the circle with radius $r$ (when the anchor point has a negligible orthogonal component to the viewing plane); a circle with radius $<r$ as the viewing angle is tilted away from the axis connecting the anchor point to the origin; a full circle with small radius as the angle increases; and finally we see an empty slice when the projection plane is orthogonal to the anchor point axis. A similar picture is found for the 5d sphere. Note however that as dimensionality increases, the larger orthogonal space means that the anchor point will have a large orthogonal component in most views.

\begin{figure*}[ht]
\centerline{\includegraphics[width=0.2\textwidth]{gifs/png/sphere-3-anchored-033.png}
\hspace{5mm}
\includegraphics[width=0.2\textwidth]{gifs/png/sphere-3-anchored-036.png}
\hspace{5mm}
\includegraphics[width=0.2\textwidth]{gifs/png/sphere-3-anchored-041.png}}
\caption{Different slices through a 3d hollow sphere with $r=1$, with anchor point $(0.7, 0.7, 0.7)$, showing full circle with small radius (left), circle with radius $<r$ (middle) and circle with radius $r$ (right).}
\label{fig:3anchored}
\end{figure*}

### Other geometric shapes
To better understand the slice tour we look at different examples of geometric shapes, see Figure \ref{fig:geoms}. For each shape two selected views are shown. The first column shows views from the slice tour on a 3d Roman surface. The second column shows slices through a 4d torus, revealing different aspects of the shape. The last column shows a 6d cube, where the upper plot shows a view along two of the original parameters, allowing to clearly identify the rectangular shape. The panel below shows that this is not typically the case when looking at a randomly selected slice.

\begin{figure*}[ht]
\centerline{\includegraphics[width=0.2\textwidth]{gifs/png/roman-surface-centered-010.png}
\hspace{5mm}
\includegraphics[width=0.2\textwidth]{gifs/png/torus-4-centered-015.png}
\hspace{5mm}
\includegraphics[width=0.2\textwidth]{gifs/png/cube-6-centered-001.png}}
\centerline{
\includegraphics[width=0.2\textwidth]{gifs/png/roman-surface-centered-032.png}
\hspace{5mm}
\includegraphics[width=0.2\textwidth]{gifs/png/torus-4-centered-033.png}
\hspace{5mm}
\includegraphics[width=0.2\textwidth]{gifs/png/cube-6-centered-063.png}
}
\caption{Different slices through a Roman surface (left), 4d torus (middle) and a 6d cube (right).}
\label{fig:geoms}
\end{figure*}



## Other examples

### Needle in a haystack
We use the pollen data as an example for a hidden feature generally occluded in projections. This 5d 1986 Exposition's dataset was made by David Coleman of RCA Labs. [XXX REF] We center and scale each variable of the dataset and run a slice tour with a thin slice ($\epsilon = 0.0005$). Selected views are shown in the first two plots in Figure \ref{fig:pollen}, indicating the presence of an interesting feature hidden in the center. We next zoom in on the center of the distribution and consider a thicker slice ($\epsilon = 0.005$) to uncover the hidden structure, shown in the last two plots of Figure \ref{fig:pollen}.

\begin{figure*}[ht]
\centerline{\includegraphics[width=0.2\textwidth]{gifs/png/pollen-007.png}
\hspace{5mm}
\includegraphics[width=0.2\textwidth]{gifs/png/pollen-092.png}
\hspace{5mm}
\includegraphics[width=0.2\textwidth]{gifs/png/pollen-zoom-075.png}
\hspace{5mm}
\includegraphics[width=0.2\textwidth]{gifs/png/pollen-zoom-018.png}
}
\caption{Different slices through the pollen dataset. The first two plots have slice volume $\epsilon = 0.0005$, the last two plots zoom in on the center and have increased volume $\epsilon = 0.005$.}
\label{fig:pollen}
\end{figure*}

### Non-linear boundaries
XXX say something about this dataset [@sam.11271]

Selected views from a slice tour of the scaled and centered data, and with large slice volume $\epsilon = 0.15$ are shown in Figure \ref{fig:wine}. The slices allow to clearly see the non-linearity of the boundary between the green and orange group. The first view also shows a non-linear boundary of the purple group. Interestingly this group does not appear at all in the second slice shown here.

\begin{figure*}[ht]
\centerline{\includegraphics[width=0.2\textwidth]{gifs/png/wine-029.png}
\hspace{5mm}
\includegraphics[width=0.2\textwidth]{gifs/png/wine-042.png}
\hspace{5mm}
\includegraphics[width=0.2\textwidth]{gifs/png/wine-049.png}
\hspace{5mm}
\includegraphics[width=0.2\textwidth]{gifs/png/wine-100.png}
}
\caption{Different slices through the wine dataset.}
\label{fig:wine}
\end{figure*}


# Discussion {#sec:discussion}

In this note we introduce a new visualization method for dynamic slicing of high-dimensional parameter spaces. It is based on interpolated projections obtained in a grand tour and generates an interpolated sequence of projected sections. The examples shown in Section XXX demonstrate the potential of this new display to find and explore concave structures, as well as other hidden features.

In applications with large number of dimensions and where only a few samples are available the method is limited. In this case thick slices may be needed to get a sufficient number of observations inside the slice, and as a result  small scale structures cannot be resolved in the slice tour. If on the other hand a large number of samples are available one may consider displaying only points inside the slice to keep a clear display.

Instead of slicing in the full $p-d=p-2$ dimensional orthogonal space we can also use a subspace in which to slice. As pointed out in @prosection combining projections with sectioning in varying numbers of dimensions can reveal the codimension of an unknown distribution. One approach would be to interpolate between projection matrices with more than two columns, and use the first two for the display projection. The remaining directions then provide an orthogonal subspace that can be used for sectioning. A subtlety to consider is that geodesic interpolation is not ideal for such applications, as it ignores rotations between the directions in the projection matrix. As alternative interpolation methods are not currently available in the R implementation, we leave such extensions for future work.

In addition slice definitions beyond a simple cutoff on the orthogonal distance should be considered, where different definition can be used to highlight certain aspects of the data. We also expect interesting new developments by combining the slice tour and the guided tour into a weighted guided tour with index functions using the distance vector information in addition to the projected data points.
