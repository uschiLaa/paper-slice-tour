---
title: |
  A slice tour for finding hollowness in high-dimensional data
type: Short Technical Note
author:
  - name: Ursula Laa
    affil: a, b
    email: ursula.laa@monash.edu
  - name: Dianne Cook
    affil: b
    email: dicook@monash.edu
affiliation:
  - num: a
    address: |
      School of Physics and Astronomy, Monash University
  - num: b
    address: |
      Department of Econometrics and Business Statistics, Monash University
bibliography: biblio.bib
abstract: |
  Projections and sectioning are complementary methods for the visualisation of
  high-dimensional data. In this note we describe slicing in the orthogonal
  space of projections obtained when running a tour, thus presenting the viewer
  with an interpolated sequence of projected sections. The method has been
  implemented in R as an extension to the tourr package, and can be used to
  explore concave structures in multivariate distributions.
keywords: |
  data visualisation; grand tour; sectioning
header-includes: |
  \usepackage{hyperref}
  \usepackage[utf8]{inputenc}
  \def\tightlist{}
output: rticles::tf_article
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

# Introduction

Modern data is typically high-dimensional and thus data visualisation often relies on some form of dimension reduction. This entails looking at (non-)linear projections of the data. Interactive and dynamic displays often provide information beyond what can be achieved in a static display. For example, the grand tour [@As85; @BCAH05] shows a smooth sequence of interpolated lower dimensional projections and allows to extrapolate the high-dimensional shape of the distribution. It is particularly useful for detecting clusters, outliers and non-linear dependence. Additionaly, we may complement projections with section information. This is often possible in interactive graphics systems by means of brushing [@ggobiCSDA2003;@JSSv081i05], where the user is selecting a region in a subspace of the dataspace that is highlighted in a projection of the data points.

The complementarity between projections and sections has previously been discussed in @prosection, dubbing the combination "prosections". These prosections allow the identification of lower-dimensional structure embedded in the high-dimensional space. One simple example is that prosections can reveal the difference between a full and hollow hypersphere. In addition to hollowness (concave structures) they can also provide a clear picture of internal structures that may be concealed in a projection. For example, @prosection uses prosections to reveal the internal structure of the four-point ultrametric locus [@locus].

Since existing approaches to sectioning are interactive, they rely on the user to redefine the section many times to explore the data. While this level of control is often preferred, it is impractical for detecting and exploring unknown structures in a dataset. As a result smaller hidden features that are only visible in specific sections of the full distribution may easily be missed. In addition having a dynamic approach to sectioning, similar to the grand tour approach to projections, will provide the viewer with context allowing to extrapolate e.g. the shape of a concave structure. We therefore propose a more systematic approach to sectioning based on interpolated projections obtained with a grand tour. The method defines a slice based on 2-d projections provided by the tour and will presents the viewer with an interpolated sequence of slices when running a tour.

The relevant definitions and an overview of the implementation in R are given in Section XXX, and in Section XXX. We then apply the newly defined slice tour to several examples in Section XXX. We consider different high-dimensional geometric shapes and XXX, showing how concave structures can be visualised and explored with a slice tour. Possible extensions are discussed in Section XXX.

<!--
A good way to visualize high-dimensional data is to display a smooth sequence of interpolated lower dimensional projections. This is called a tour [@As85; @BCAH05] and allows to extrapolate the high-dimensional shape of the distribution. It is particularly useful for detecting clusters, outliers and non-linear dependence. A limitation of this approach is that concavities in a distribution may be hidden when looking at projections. A simple example are projections of samples on a hypersphere. No projection of such a distribution allows to distinguish a hollow sphere from a full one. On the other hand, the difference would be obvious when looking at a slice through the center of the sphere.

Slicing or sectioning can be thought of as complementary to projections when visualizing high-dimensional data, as discussed in detail in @prosection. To overcome the respective shortcomings of each method, it is suggested to use a composition of sections and projections, so-called "prosections". In practice sectioning is typically performed in interactive graphics displays in the form of brushing [XXX reference?], i.e. the user is selecting a region in a subspace of the high-dimensional dataspace that is highlighted in a projection of the data points.
More recently @JSSv081i05 suggested conditional visualization for statistical models by selecting sections in data space for detailed comparisons of a fitted model to the observed data. Similar to brushing, the section is selected interactively by the user, by choosing a point in low-dimensional displays showing the data in the space of conditioning predictors.

Here we propose a systematic approach to slicing that does not rely on the user choosing sections to display, but will present the viewer with an interpolated sequence showing different slices of parameter space. The method is based on the grand tour, and uses the orthogonal distance from the current plane to define the section corresponding to each view in an interpolated tour path. We demonstrate how this can be used to gain insights into the concave structure of a dataset, using the example of hollow hyperspheres defined in 3 or more dimensions.
-->

# Method

The basis underlying our approach is the grand tour. We first briefly review the relevant concepts. Building on these ideas we introduce a method for displaying slices of parameter space that are defined for each projection matrix.

## Tour review

A tour is providing a continuous animation, showing a sequence of $d$-dimensional (typically $d=1$ or $2$) projections from $n$-dimensional parameter space. The tour combines basis selection with basis interpolation. In a grand tour the basis selection is random (each new basis is chosen from all possible projections), and typically geodesic interpolation is used to generate smooth transitions between viewing planes. Different basis selection methods as well as the geodesic interpolation are implemented in the `tourr` package [@tourr] in R [@rref], which also provides several display functions for viewing the tour.

The notation used in the following for the description of each projection is denoting $\mathbf{X}$ the $m\times n$ dimensional data matrix ($m$ observations in $n$ dimensions) and $\mathbf{A}$ an orthonormal $n \times d$ projection matrix. The $d$-dimensional projection of the data is thus given by $\mathbf{Y} = \mathbf{X}\cdot\mathbf{A}$, giving the $n\times d$ dimensional projected data matrix to be plotted in each frame of the tour display.

In the following we are interested in the orthogonal distance of scatter points from an anchored projection plane, thus $d=2$. 

## Slicing in the orthogonal space

### Distance from the origin

In addition to the projected data $\mathbf{Y}$ we calculate for each projection the orthogonal distance of the data points from the current projection plane centered at the origin, $v$. The orthogonal component is given by
\begin{equation}
x_i' = x_i - (x_i\cdot a_1) a_1 - (x_i\cdot a_2) a_2
\end{equation}
with $x_i, i=1,...,m$ an $n$-dimensional observation in $\mathbf{X}$ and $a_i, i=1,2$ denoting the columns of the projection matrix, $\mathbf{A}=(a_1, a_2)$.
Calculating the euclidean norm of $x'$ is straightforward thanks to the orthonormality of $\mathbf{A}$, and gives the components of the required distance vector.
\begin{equation}
\tilde{v}_i^2 = ||x_i'||^2 = x_i^2 - (x_i\cdot a_1)^2 - (x_i\cdot a_2)^2.
\end{equation}
We also see that this is trivially generalizing for orthonormal projection matrices with $d>2$.

The distance vector can then be used to display a slice tour by highlighting points for which the orthogonal distance is smaller than a selected cutoff value $h$. In general a larger cutoff value and/or much larger sample sizes are required as the original dimensionality ($n$) increases. For practical purposes we therefore specify a volume $\epsilon$ and then use as a cutoff $h = \epsilon^{1/n}$.

XXX Example 2x2, row 1-col 1 has a slice projection  of a solid 4D spehere, row 1-col 2 has a slice projectionof a hollow 4D sphere; row 2-col 1 has a slice projection of a  solid 4D cube, row 1-col 2 has a slice projection of a hollow 4D cube

### Slice thickness

XXXX maybe the problem is that each plane is 2d, but the cap assumes I am cutting with a hyperplane that is n-1, so it works as expected in 3d, beyond that i need to account for volume effects in the n-2 dimensions, but how?
e.g. consider 1-d sliced of 3d sphere, in that case I get the volume of the slice as a pipe of radius h, so for n-d sphere I need the volume of n-1 d sphere of radius h but translated across the plane (but what does that really mean)?

The thickness of the slice should be chosen such that enough points are inside the slice be representative of the distribution. This will depend on the total number of points in the dataset, its original dimensionality and on the distribution. Here we estimate the number of points inside a slice of thickness $h$ for the rotation invariant example of an $n$ dimensional full hypersphere with radius $R$, assuming uniformly distributed points throughout the sphere. This means we calculate the relative volume inside the slice as a function of $h$ and $n$.

The total volume of the full hypersphere is given as
\begin{equation}
V_n(R) = \frac{\pi^{n/2}}{\Gamma(\frac{n}{2} + 1)} R^n.
\end{equation}
To calculate the volume of the slice we subtract the volume of a hypersphere cap of hight $h'=r-h$, as given in @capVol,
\begin{equation}
V^{\phi}_n(R) = \frac{1}{2}V_n(R) I_{sin^2\phi}(\frac{n+1}{2},\frac{1}{2}),
\end{equation}
where $I$ is the regularized incomplete beta function and $\phi =\arccos(1-\frac{h'}{r}) = \arccos(\frac{h}{r})$ the colatitude angle (XXX got this off the paper, don't yet understand the angle..).
The relative volume of the slice is thus given as (XXX better names needed!)
\begin{equation}
V_n^h(R) = \frac{V_n(R) - 2 V^{\phi}_n(R)}{V_n(R)} = 1 - I_{1-\frac{h^2}{r^2}}(\frac{n+1}{2},\frac{1}{2}),
\end{equation}
using $\sin(\arccos(x)) = \sqrt{1-x^2}$.

In the case of a hollow hypersphere we are instead interested in the relative area inside the slice. We use the cap area derived in @capVol to calculate the area inside the slice as
\begin{equation}
A_n^h(R) = \frac{A_n(R) - 2 A^{\phi}_n(R)}{A_n(R)} = 1 - I_{1-\frac{h^2}{r^2}}(\frac{n-1}{2},\frac{1}{2}).
\end{equation}

### Anchoring

The above definition implicitly assumes that we slice the distribution using the origin as a reference point. This is generally a good starting point assuming the data is centered before applying the slice tour. Alternative reference points can however provide additional insight into the concave structure of the distribution. We can also use the mean in each parameter as an anchor point if the data is not centered.

We therefore generalize the distance vector to measure the anchored orthogonal distance, i.e. distance with respect to the anchor $\alpha$ used as a reference point.

In general $\alpha$ can be any point in the $n$-dimensional parameter space, but we are only interested in the orthogonal component, thus we use $\alpha' = \alpha - (\alpha\cdot a_1) a_1 - (\alpha\cdot a_2 )a_2$ to define the generalized measure of orthogonal distance as
\begin{equation}
v_i^2 = ||x_i' - \alpha'||^2 = x_i'^2 + \alpha'^2 - 2 x_i'\cdot\alpha'
\end{equation}

where the cross term can be expressed as

\begin{equation}
x_i'\cdot\alpha' = x_i\cdot\alpha - (\alpha\cdot a_1) (x_i\cdot a_1) - (\alpha\cdot a_2) (x_i\cdot a_2).
\end{equation}

Using the generalized distance measure with a cutoff volume $\epsilon$ then corresponds to moving a slice of fixed thickness to be centered around the anchor point $\alpha$ in the space orthogonal to the current projection plane. In three dimensions this simply corresponds to moving up or down along the orthogonal direction.



# Implementation

The slice tour has been implemented in R [@rref] as a new display method `display_slice` in the `tourr` package [@tourr]. In addition to usual parameters the user can choose the volume parameter $\epsilon$ by setting `eps` and, if required, the anchor point $\alpha$ is set by the `anchor` argument. By default `eps=0.001` and `anchor=NULL`, resulting in slicing through the origin. In addition the user can select the marker symbols for point inside and outside the slice. By default points in the slice are highlighted as `pch_slice  = 20` and `pch_other = 46`, i.e. plotting a bullet for points inside the slice, and a dot for points outside.

XXX R code

# Examples

XXX choose 6

To demonstrate the slice tour we sample points on the surface of a sphere with radius $r=1$ in $n=3$ and $n=5$ dimensions. We use the `geozoo` package [@geozoo] to draw 2000 (5000) points on the 3d (5d) sphere.

For both examples we start by slicing through the origin with the default parameters, in particular $\epsilon = 0.001$, i.e. $h = 0.1$ in 3d and $h = 0.25$ in 5d. Slicing through the origin results in sections where the points inside the slice are approximately on a circle with the full radius. Snapshots of the slice tour animation are shown in Figure \ref{fig:centered}, animated gifs are available at XXX. Notice that the larger number of points and increased thickness parameter $h$ do not make up for the reduced number of points inside the slice through the 5d hypersphere. (projected points are on average closer to the center as we increase the dimension of the hypersphere, is there some convergence similar to central limit theorem at play?)

\begin{figure*}[ht]
\centerline{\includegraphics[width=0.3\textwidth]{gifs/png/sphere-3-centered-055.png}\hspace{1cm}
\includegraphics[width=0.3\textwidth]{gifs/png/sphere-5-centered-055.png}}
\caption{Slice through a 3d (left) and 5d (right) hollow sphere, anchored at the origin. Points inside the slice are highlighted with a bullet marker and are found on a circle with the radius of the hypersphere, $r$.}
\label{fig:centered}
\end{figure*}

It is also instructive to look at the sliced spheres with an off-center anchor point. In this case the different views obtained in the slice tour reveal more of the concave structure of the distribution. Figure \ref{fig:3anchored} shows example views from a slice tour on a 3d sphere with $r=1$ and anchor point $(0.7, 0.7, 0.7)$. Notice that the anchor point was chosen to fall outside the sphere. Depending on the viewing angle selected by the tour the slice contains points on the circle with radius $r$ (when the anchor point has a negligible orthogonal component to the viewing plane); a circle with radius $<r$ as the viewing angle is tilted away from the axis connecting the anchor point to the origin; a full circle with small radius as the angle increases; and finally we see an empty slice when the projection plane is orthogonal to the anchor point axis.


\begin{figure*}[ht]
\centerline{\includegraphics[width=0.3\textwidth]{gifs/png/sphere-3-anchored-033.png}
\includegraphics[width=0.3\textwidth]{gifs/png/sphere-3-anchored-036.png}
\includegraphics[width=0.3\textwidth]{gifs/png/sphere-3-anchored-041.png}}
\caption{Different slices through a 3d hollow sphere with $r=1$, with anchor point $(0.7, 0.7, 0.7)$, showing full circle with small radius (left), circle with radius $<r$ (middle) and circle with radius $r$ (right).}
\label{fig:3anchored}
\end{figure*}

The same behavior is observed when slicing the 5d hollow sphere with an off-center anchor point, however a large number of sample points is required to get a similarly clear display to that found for the 3d sphere. The animation showing the anchored slice tour of the 5d hollow sphere with 5000 sample points is available at XXX. In this example the anchor point was fixed to $(0.5,0.5,0.5,0.5,0.5)$.

# Summary and Outlook

In this note we introduce a new visualization method for systematic slicing of high-dimensional parameter spaces, based on interpolated projections obtained in a grand tour. The application to the hollow sphere demonstrates the potential of this new display to find and explore concave structures in distributions.

In applications with large number of dimensions and where only a few samples are available the method is limited. In this case thick slices may be needed to get a sufficient number of observations inside the slice, and as a result  small scale concavities cannot be resolved in the slice tour. If on the other hand a large number of samples are available one may consider displaying only points inside the slice to keep a clear display.

Instead of slicing in the full $n-d=n-2$ dimensional orthogonal space we can also use a subspace in which to slice. As pointed out in @prosection combining projections with sectioning in varying numbers of dimensions can reveal the codimension of an unknown distribution. One approach would be to interpolate between projection matrices with more than two columns, and use the first two for the display projection. The remaining directions then provide an orthogonal subspace that can be used for sectioning. A subtlety to consider is that geodesic interpolation is not ideal for such applications, as it ignores rotations between the directions in the projection matrix. As alternative interpolation methods are not currently available in the R implementation, we leave such extensions for future work.

We also expect interesting new developments by combining the slice tour and the guided tour into a weighted guided tour with index functions using the distance vector information in addition to the projected data points.
